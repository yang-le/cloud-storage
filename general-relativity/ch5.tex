\chapter{微分形式及其积分}

\section{微分形式}

先介绍$n$维矢量空间$V$上的``形式''，再讨论$n$维流形$M$上的``微分形式场''。

\begin{definition}
    $\omega_{a_1 \cdots a_l} \in \mathscr{T}_V(0, 1)$叫$V$上的$l$次形式（简称$l$形式），若
    $$\omega_{a_1 \cdots a_l} = \omega_{[a_1 \cdots a_l]}$$
\end{definition}

为书写方便，有时略去下标而把$l$形式$\omega_{a_1 \cdots a_l}$写为$\omega$。

\begin{theorem}
    \begin{enumerate}[（a）]
        \item $\omega_{a_1 \cdots a_l} = \omega_{[a_1 \cdots a_l]} \Rightarrow \text{对任意基底有} \omega_{\mu_1 \cdots \mu_l} = \omega_{[\mu_1 \cdots \mu_l]}$
        \item $\text{存在基底使} \omega_{\mu_1 \cdots \mu_l} = \omega_{[\mu_1 \cdots \mu_l]} \Rightarrow \omega_{a_1 \cdots a_l} = \omega_{[a_1 \cdots a_l]}$
    \end{enumerate}
\end{theorem}

\begin{theorem}
    \begin{enumerate}[（a）]
        \item $\omega_{a_1 \cdots a_l} = \delta_\pi\omega_{a_{\pi(1)} \cdots a_{\pi(l)}}$
        \item $\text{对任意基底} \omega_{\mu_1 \cdots \mu_l} = \delta_\pi\omega_{\mu_{\pi(1)} \cdots \mu_{\pi(l)}}$
    \end{enumerate}
    其中$\pi$代表$(1, \cdots, l)$的一种排列，$\pi(1)$是指$\pi$所代表的那种排列中的第$1$个数字，$\delta_\pi \equiv \pm 1$（偶排列取$+$，奇排列取$-$）。
\end{theorem}

由上可知，在$l$形式的分量$\omega_{\mu_1 \cdots \mu_l}$中，凡有重复具体指标者必为零，例如
$$\omega_{112} = \omega_{133} = \omega_{212} = 0$$

$V$上全体$l$形式的集合记作$\Lambda(l)$。$1$形式其实就是$V$上的对偶矢量，故$\Lambda(1) = V^*$。
约定把任一实数称为$V$上的$0$形式，则$\Lambda(0) = \mathbb{R}$。
$l$形式既然是$(0, l)$型张量，自然有$\Lambda(l) \subset \mathscr{T}_V(0, l)$。
不但如此，还容易证明$\Lambda(l)$是$\mathscr{T}_V(0, l)$的线性子空间，其维数的计算可从关于$\mathscr{T}_V(k, l)$维数的计算得到启发：
为求$\mathscr{T}_V(k, l)$的维数可先找一个基底，而为此则要先定义张量积。
然而两个微分形式（作为两个张量）的张量积并非全反称，故不再是微分形式。
但可对全体指标施行全反称操作使之成为微分形式，于是有如下定义

\begin{definition}
    设$\omega$和$\mu$分别为$l$形式和$m$形式，则其楔形积（简称楔积）是按下式定义的$l + m$形式：
    $$(\omega \wedge \mu)_{a_1 \cdots a_l b_1 \cdots b_m} \coloneq \frac{(l+m)!}{l!m!}\omega_{[a_1 \cdots a_l}\mu_{b_1 \cdots b_m]}$$
    或者说，楔积是满足上式的映射$\wedge \colon \Lambda(l) \times \Lambda(m) \to \Lambda(l + m)$
\end{definition}

楔积$(\omega \wedge \mu)_{a_1 \cdots a_l b_1 \cdots b_m}$亦可记作$\omega_{a_1 \cdots a_l} \wedge \mu_{b_1 \cdots b_m}$，也常简记为$\omega \wedge \mu$。

由定义可知楔积满足结合律和分配律，即$(\omega \wedge \mu) \wedge \nu = \omega \wedge (\mu \wedge \nu)$（因而$\omega \wedge \mu \wedge \nu$有明确意义）和$\omega \wedge (\mu + \nu) = \omega \wedge \mu + \omega \wedge \nu$。
但楔积一般不服从交换律，例如对$1$形式$\omega$和$\mu$有
$$\omega \wedge \mu \equiv \omega_a \wedge \mu_b \equiv (\omega \wedge \mu)_{ab} = 2\omega_{[a}\mu_{b]} = \omega_a\mu_b - \omega_b\mu_a$$
$$\mu \wedge \omega \equiv (\mu \wedge \omega)_{ab} = 2\mu_{[a}\omega_{b]} = \mu_a\omega_b - \mu_b\omega_a$$
可见对两个$1$形式的楔积有$\omega \wedge \mu = - \mu \wedge \omega$。
推广至一般情况，设$\omega$和$\mu$分别是$l$和$m$形式，则
$$\omega \wedge \mu = (-1)^{lm} \mu \wedge \omega$$

\begin{theorem}
    设$\dim V = n$，则$\dim \Lambda(l) = C_n^l = \frac{n!}{l!(n - l)!}$，若$l \leq n$；
    $\Lambda(l) = \{0\}$（只有零元），若$l > m$。
\end{theorem}

下面回到流形$M$上来。
若对$M$（或$A \subset M$）的任一点$p$指定$V_p$上的一个$l$形式，就得到$M$（或$A$）上的一个$l$形式场（``场''字常略去）。
$1$形式场和$0$形式场分别是对偶矢量场和标量场。
$M$上的光滑的$l$形式场称为$l$次微分形式场，也简称作$l$形式场或$l$形式。

设$(O, \psi)$为一坐标系，则$O$上的$l$形式场可方便地用对偶坐标基底场$\{(\mathrm{d}x^\mu)_a\}$逐点线性表出。
$$\omega_{a_1 \cdots a_l} = \sum_C \omega_{\mu_1 \cdots \mu_l}(\mathrm{d}x^{\mu_1})_{a_1} \wedge \cdots \wedge (\mathrm{d}x^{\mu_l})_{a_l}$$
其中
$$\omega_{\mu_1 \cdots \mu_l} = \omega_{a_1 \cdots a_l}(\partial / \partial x^{\mu_1})^{a_1} \cdots (\partial / \partial x^{\mu_l})^{a_l}$$
是$O$上的函数。
一个重要的特例是$l = n$的情况。因为$C_n^l = C_n^n = 1$，上式右边的求和只有一项，即
$$\omega_{a_1 \cdots a_n} = \omega_{1 \cdots n}(\mathrm{d}x^{1})_{a_1} \wedge \cdots \wedge (\mathrm{d}x^{n})_{a_n}$$
简写为
$$\omega = \omega_{1 \cdots n}\mathrm{d}x^{1} \wedge \cdots \wedge \mathrm{d}x^{n}$$
上式也可以这样理解：$M$中任一点$p$的所有$n$形式的集合是$1$维矢量空间，只有一个基矢，可取为$\mathrm{d}x^{1} \wedge \cdots \wedge \mathrm{d}x^{n}|_p$，上式就是$\omega|_p$用这一基矢的展开式。
注意，展开系数$\omega_{1 \cdots n}$对不同点可以不同，因而是坐标域上的函数，也可表为坐标的$n$元函数$\omega_{1 \cdots n}(x^1, \cdots, x^n)$。

我们以$\Lambda_M(l)$代表$M$上全体$l$形式场的集合。

\begin{definition}
    流形$M$上的外微分算符是一个映射$\mathrm{d} \colon \Lambda_M(l) \to \Lambda_M(l + 1)$，定义为
    $$(\mathrm{d}\omega)_{b a_1 \cdots a_l} \coloneq (l + 1)\nabla_{[b}\omega_{a_1 \cdots a_l]}$$
    其中$\nabla_b$为任一导数算符（因由$C^c{}_{ab} = C^c{}_{ba}$可证对任意$\nabla_a$和$\tilde\nabla_a$有$\tilde\nabla_{[b}\omega_{\cdots]} = \nabla_{[b}\omega_{\cdots]}$）。
    可见在定义外微分之前无须在$M$上指定导数算符（及任何其他附加结构，如度规）。
\end{definition}

\begin{example}
    第二章曾定义过$(\mathrm{d}f)_a$，第三章又知$(\mathrm{d}f)_a = \nabla_af$，可见$(\mathrm{d}f)_a$就是$f \in \Lambda_M(0)$的外微分，这正是当时用符号$\mathrm{d}f$的原因。
\end{example}

把$l$形式场$\omega$写成对偶坐标基矢的展开式的一个好处是便于计算$\mathrm{d}\omega$，请看如下定理

\begin{theorem}
    设$\omega_{a_1 \cdots a_l} = \sum\limits_C \omega_{\mu_1 \cdots \mu_l}(\mathrm{d}x^{\mu_1})_{a_1} \wedge \cdots \wedge (\mathrm{d}x^{\mu_l})_{a_l}$，则
    $$(\mathrm{d}\omega)_{b a_1 \cdots a_l} = \sum_C (\mathrm{d}\omega_{\mu_1 \cdots \mu_l})_b \wedge (\mathrm{d}x^{\mu_1})_{a_1} \wedge \cdots \wedge (\mathrm{d}x^{\mu_l})_{a_l}$$
\end{theorem}

\begin{proof}
    选该系的普通导数算符$\partial_b$作为$\nabla_b$，结合$(\mathrm{d}\omega)_{b a_1 \cdots a_l}$的定义即可得证。
\end{proof}

\begin{theorem}
    $\mathrm{d} \comp \mathrm{d} = 0$
\end{theorem}

\begin{proof}
    选任一坐标系的导数算符$\partial_b$作为$\nabla_b$，便有
    $$[\mathrm{d}(\mathrm{d}\omega)]_{c b a_1 \cdots a_l} = (l + 2)(l + 1)\partial_{[c}\partial_{[b}\omega_{a_1 \cdots a_l]]} = (l + 2)(l + 1)\partial_{[[c}\partial_{b]}\omega_{a_1 \cdots a_l]} = 0$$
    其中第二步是因为同种括号内的子括号可以随意增删，最后一步是因为$\partial_{[a}\partial_{b]}T^{\cdots}{}_{\cdots} = 0$。
\end{proof}

\begin{definition}
    设$\omega$为$M$上的$l$形式场。$\omega$叫闭的，若$\mathrm{d}\omega = 0$；$\omega$叫恰当的，若存在$l - 1$形式场$\mu$使$\omega = \mathrm{d}\mu$。
\end{definition}

因此，前述定理亦可表述为：若$\omega$是恰当的，则$\omega$是闭的。
然而，要使逆命题成立则还须对流形$M$提出一定要求（略）。
平凡流形$\mathbb{R}^n$满足这一要求，而流形一定局域平凡，所以对任意流形$M$而言，闭的$l$形式场至少是局域恰当的。
就是说，设$\omega$是流形$M$上的闭的$l$形式场，则$M$的任一点$p$必有邻域$N$，在$N$上存在$l - 1$形式场$\mu$使$\omega = \mathrm{d}\mu$。

\begin{theorem}
    当$M = \mathbb{R}^2$时，上述定理及其逆定理给出普通微积分的下述命题：
    给定函数$X(x, y)$及$Y(x, y)$，存在函数$f(x, y)$使$\mathrm{d}f = X\mathrm{d}x + Y\mathrm{d}y$的充要条件是$\partial X / \partial y = \partial Y / \partial x$。
\end{theorem}

\begin{proof}
    由定义知$1$形式场$X\mathrm{d}x + Y\mathrm{d}y$的外微分为
    \[\begin{split}
        \mathrm{d}(X\mathrm{d}x + Y\mathrm{d}y) &= \mathrm{d}X \wedge \mathrm{d}x + \mathrm{d}Y \wedge \mathrm{d}y = (\frac{\partial X}{\partial x}\mathrm{d}x + \frac{\partial X}{\partial y}\mathrm{d}y)\wedge\mathrm{d}x + (\frac{\partial Y}{\partial x}\mathrm{d}x + \frac{\partial Y}{\partial y}\mathrm{d}y)\wedge\mathrm{d}y \\
        &= \frac{\partial X}{\partial y}\mathrm{d}y \wedge \mathrm{d}x + \frac{\partial Y}{\partial x}\mathrm{d}x \wedge \mathrm{d}y = (\frac{\partial Y}{\partial x} - \frac{\partial X}{\partial y})\mathrm{d}x \wedge \mathrm{d}y
    \end{split}\]
    \begin{enumerate}[（A）]
        \item 若存在函数$f$使$1$形式等式$\mathrm{d}f = X\mathrm{d}x + Y\mathrm{d}y$成立，则
        $$(\frac{\partial Y}{\partial x} - \frac{\partial X}{\partial y})\mathrm{d}x \wedge \mathrm{d}y = \mathrm{d}\mathrm{d}f = 0$$
        故$\partial X / \partial y = \partial Y / \partial x$。
        \item 若$\partial X / \partial y = \partial Y / \partial x$，则$\mathrm{d}(X\mathrm{d}x + Y\mathrm{d}y) = 0$，即$1$形式场$X\mathrm{d}x + Y\mathrm{d}y$为闭，于是$X\mathrm{d}x + Y\mathrm{d}y$为恰当，即存在函数$f$使$\mathrm{d}f = X\mathrm{d}x + Y\mathrm{d}y$。
    \end{enumerate}
\end{proof}

\section{流形上的积分}

先以$3$维欧氏空间$(\mathbb{R}^3, \delta^a{}_{b})$为例。
设$\vec{v}$为矢量场，$L$为光滑曲线，$S$为光滑曲面。
在指定$L$的方向和$S$的法向之前，积分$\displaystyle\int_L\vec{v}\cdot\mathrm{d}\vec{l}$和$\displaystyle\iint_S\vec{v}\cdot\mathrm{d}\vec{S}$都只唯一确定到差一个负号的程度。
要完全确定这两个积分，就要指定$L$的方向和$S$的法向。
推而广之，计算任意流形上的积分之前应指定该流形的``定向''。
然而，并非所有流形都是可定向的。

\begin{definition}
    $n$维流形称为可定向的，若其上存在$C^0$且处处非零的$n$形式场$\epsilon$。
\end{definition}

\begin{example}
    $\mathbb{R}^3$是可定向流形，因为其上存在$C^\infty$的$3$形式场$\epsilon \equiv \mathrm{d}x \wedge \mathrm{d}y \wedge \mathrm{d}z$，其中$x, y, z$为自然坐标。
\end{example}

\begin{example}
    莫比乌斯带是不可定向流形。
\end{example}

\begin{definition}
    若在$n$维可定向流形$M$上选定一个$C^0$且处处非零的$n$形式场$\epsilon$，就说$M$是定向的（``已经定向''之意）。
    设$\epsilon_1$和$\epsilon_2$是两个$C^0$且处处非零的$n$形式场，若存在处处为正的函数$h$使$\epsilon_1 = h\epsilon_2$，就说$\epsilon_1$和$\epsilon_2$给出$M$的同一个定向。
\end{definition}

\begin{note}
    从给出$M$的定向这个角度看，满足$\epsilon_1 = h\epsilon_2 ~ (h > 0)$的$\epsilon_1$和$\epsilon_2$是等价的。
    由于$n$维流形$M$上每点的全体$n$形式的集合是$1$维矢量空间，任意两个$n$形式场$\epsilon_1$和$\epsilon_2$必有关系$\epsilon_1 = h\epsilon_2$其中$h$是$M$上的函数。
    若$\epsilon_1$和$\epsilon_2$处处非零，则$h$处处非零；若$\epsilon_1$和$\epsilon_2$为$C^0$的，则$h$为$C^0$的。
    对连通流形\footnote{
        拓扑空间$(X, \mathscr{T})$称为连通的，若它只有两个既开又闭的子集；
        称为弧连通的，若$X$的任意两点可被一条在$X$中的连续曲线连接。
        流形称为连通的（或弧连通的），若其底拓扑空间是连通的（或弧连通的）。
        对拓扑空间，弧连通必定连通，但连通不一定弧连通（存在``擦边性''反例）。
        对流形，弧连通与连通等价。
    }来说（我们只讨论连通流形），一个处处非零的连续函数只能处处为正或处处为负。可见连通流形只能有两种定向。
\end{note}

\begin{definition}
    $M$上选好以$\epsilon$为代表的定向后，开域$O \subset M$上的基底场$\{(e_\mu)^a\}$叫做以$\epsilon$衡量为右手的，若$O$上存在处处为正的函数$h$使$\epsilon = h(e^1)_{a_1} \wedge \cdots \wedge (e^n)_{a_n}$，其中$\{(e^\mu)_a\}$是$\{(e_\mu)^a\}$的对偶基（否则称为左手的）。
    一个坐标系叫右（左）手系，若其坐标基底是右（左）手的。
\end{definition}

下面介绍$n$维定向流形$M$上的$n$形式场$\omega$的积分。
$\omega$可用对偶坐标基矢的楔形积$\mathrm{d}x^1 \wedge \cdots \wedge \mathrm{d}x^n$展开为
$$\omega = \omega_{1 \cdots n}(x^1, \cdots, x^n)\mathrm{d}x^1 \wedge \cdots \wedge \mathrm{d}x^n$$
可见每一$n$形式场$\omega$在坐标域上给出一个$n$元函数$\omega_{1 \cdots n}(x^1, \cdots, x^n)$，我们就把这个$n$元函数的普通$n$重积分称为$n$形式场$\omega$的积分，准确定义如下：

\begin{definition}
    设$(O, \psi)$是$n$维定向流形$M$上的右手坐标系，$\omega$是开子集$G \subset O$上的连续$n$形式场，则$\omega$在$G$上的积分定义为
    $$\int_G\omega \coloneq \int_{\psi[G]}\omega_{1 \cdots n}(x^1, \cdots, x^n)\mathrm{d}x^1 \cdots \mathrm{d}x^n$$
    上式右边是$n$元函数$\omega_{1 \cdots n}(x^1, \cdots, x^n)$在$\mathbb{R}^n$的开子集$\psi[G]$上的普通积分\footnote{指Riemann或Lebesgue积分}，早已有定义。
\end{definition}

\begin{note}
    \begin{enumerate}[（1）]
        \item 为说明上述定义的合理性，还应证明$\omega$在$G$上的积分与所选右手坐标系无关。
        仅以$n = 2$为例证明如下。
        
        设$(O, \psi)$和$(O', \psi')$为右手坐标系，满足$G \subset O \cap O'$，两坐标分别记作$x^1, x^2$和$x'^1, x'^2$，则
        $$\omega = \omega_{12}\mathrm{d}x^1 \wedge \mathrm{d}x^2 = \omega'_{12}\mathrm{d}x'^1 \wedge \mathrm{d}x'^2$$
        令$\displaystyle\int_G\omega \equiv \int_{\psi[G]}\omega_{12}\mathrm{d}x^1\mathrm{d}x^2, ~ (\int_G\omega)' \equiv \int_{\psi'[G]}\omega'_{12}\mathrm{d}x'^1\mathrm{d}x'^2$,欲证
        $$(\int_G\omega)' = \int_G\omega$$
        由张量变换律知$\omega'_{12} = \displaystyle\frac{\partial x^1}{\partial x'^1}\frac{\partial x^2}{\partial x'^2}\omega_{12} + \frac{\partial x^2}{\partial x'^1} \frac{\partial x^1}{\partial x'^2}\omega_{21} = \omega_{12}\det(\frac{\partial x^\mu}{\partial x'^\nu})$,其中
        $$\det(\frac{\partial x^\mu}{\partial x'^\nu}) \equiv \begin{vmatrix}
            \displaystyle\frac{\partial x^1}{\partial x'^1} & \displaystyle\frac{\partial x^1}{\partial x'^2} \\
            \\
            \displaystyle\frac{\partial x^2}{\partial x'^1} & \displaystyle\frac{\partial x^2}{\partial x'^2}
        \end{vmatrix}$$
        是这个变换的雅克比行列式。根据二重积分的换元公式\footnote{
            设$f(x, y)$在$xOy$平面上的闭区域$D$上连续，变换
            $$T \colon x = x(u, v), ~ y = y(u, v)$$
            将$uOv$平面上的闭区域$D'$变为$xOy$平面上的$D$,且满足
            \begin{enumerate}[（1）]
                \item $x(u, v), ~ y(u, v)$在$D'$上具有一阶连续偏导数
                \item 在$D'$上雅克比行列式
                $$J(u, v) = \frac{\partial(x, y)}{\partial(u, v)} \neq 0$$
                \item 变换$T \colon D' \to D$是一一到上的
            \end{enumerate}
            则有
            $$\iint_Df(x, y)\mathrm{d}x\mathrm{d}y = \iint_{D'}f[x(u, v), y(u, v)]|J(u,v)|\mathrm{d}u\mathrm{d}v$$
        },
        $$\int_{\psi[G]}\omega_{12}\mathrm{d}x^1\mathrm{d}x^2 = \int_{\psi'[G]}\omega_{12}\det(\partial x^\mu / \partial x'^\nu)\mathrm{d}x'^1\mathrm{d}x'^2 = \int_{\psi'[G]}\omega'_{12}\mathrm{d}x'^1\mathrm{d}x'^2$$
        故得证。

        然而，如果$\{x^\mu\}$和$\{x'^\mu\}$分别是右、左手系，则$\det(\partial x^\mu / \partial x'^\nu) < 0$，等号右边的$\det(\partial x^\mu / \partial x'^\nu)$应改为$|\det(\partial x^\mu / \partial x'^\nu)| = -\det(\partial x^\mu / \partial x'^\nu)$, 故上式变为
        $$\int_{\psi[G]}\omega_{12}\mathrm{d}x^1\mathrm{d}x^2 = -\int_{\psi'[G]}\omega_{12}\det(\partial x^\mu / \partial x'^\nu)\mathrm{d}x'^1\mathrm{d}x'^2 = -\int_{\psi'[G]}\omega'_{12}\mathrm{d}x'^1\mathrm{d}x'^2$$
        因此，为了定义出同一积分，当$\{x^\mu\}$是左手系时应把$\displaystyle\int_G\omega$定义为
        $$\int_G\omega \coloneq -\int_{\psi[G]}\omega_{1 \cdots n}(x^1, \cdots, x^n)\mathrm{d}x^1 \cdots \mathrm{d}x^n$$
        \item 一个坐标系是右手系还是左手系取决于流形所选的定向，故$\displaystyle\int_G\omega$是依赖于由$\epsilon$所给出的定向的，定向改变后积分变号。
        \item 以上之定义了$\omega$在坐标域内开子集$G$上的积分。
        $\omega$在全流形$M$上的积分$\displaystyle\int_M\omega$可由局部积分``缝合''而成，其定义涉及``单位分解'',从略。
    \end{enumerate}
\end{note}

设$S, M$是流形，维数分别是$l$和$n(>l)$，$\phi \colon S \to M$是嵌入。
因为$\phi[S]$是子流形，当然可谈及其上的$l$形式场$\mu$的积分。
然而``$\phi[S]$嵌入在$M$内''的事实导致``$\phi[S]$上的$l$形式场''具有两种可能的含义。
正如``$\phi[S]$上的切矢场''有切于和不切于$\phi[S]$之分那样，``$\phi[S]$上的$l$形式场''也可分为``切于''和不``切于''$\phi[S]$两种。
准确地说，$\phi[S]$上的$l$形式场$\mu$称为``切于''$\phi[S]$的，如果$\forall q \in \phi[S]$，$\mu|_q$是$W_q$（而非$V_q$）上的$l$形式（能把$W_q$的任意$l$个元素变为一个实数的线性映射）。
``$\phi[S]$上的$l$形式场''既可能是``切于''$\phi[S]$的，也可能不是``切于''$\phi[S]$的。
因为谈及$l$形式场在$\phi[S]$上的积分时是把$\phi[S]$作为独立流形看待的（不顾及它``外面''的情况），所以只有``切于''$\phi[S]$的$l$形式场$\mu$的积分才有意义。
不过，既然$\phi[S]$上的、不``切于''$\phi[S]$的$l$形式场$\mu$是能把每点$q \in \phi[S]$的$V_q$（而不只是$W_q$）的任意$l$个元素变为一个实数的线性映射，而$W_q$无非是$V_q$的子空间，只要把$\mu$的作用范围限制在$W_q$便得到一个``切于''$\phi[S]$的$l$形式场，我们把它记作$\tilde\mu$,并称之为$\mu$的限制。
准确说来有如下定义

\begin{definition}
    设$\mu_{a_1 \cdots a_l}$是$l$维子流形$\phi[S] \subset M$上的$l$形式场。
    $\phi[S]$（看作脱离$M$而独立存在的流形）上的$l$形式场$\tilde\mu_{a_1 \cdots a_l}$称为$\mu_{a_1 \cdots a_l}$在$\phi[S]$上的限制，若
    $$\tilde\mu_{a_1 \cdots a_l}|_q(\omega_1)^{a_1} \cdots (\omega_l)^{a_l} = \mu_{a_1 \cdots a_l}|_q(\omega_1)^{a_1} \cdots (\omega_l)^{a_l}, ~ \forall q \in \phi[S], ~ (\omega_1)^a, \cdots (\omega_l)^a \in W_q$$
\end{definition}

今后凡谈及$l$形式场$\mu$在$l$维子流形$\phi[S]$上的积分时，一律理解为$\mu$的限制$\tilde\mu$的积分，即总把$\displaystyle\int_{\phi[S]}\mu$理解为$\displaystyle\int_{\phi[S]}\tilde\mu$。

\section{Stokes定理}

$3$维欧氏空间的Stokes定理
$$\iint_S(\vec\nabla \times \vec{A})\cdot\mathrm{d}\vec{S} = \oint_L\vec{A}\cdot\mathrm{d}\vec{l}$$
和Gauss定理
$$\iiint_V(\vec\nabla\cdot\vec{A})\mathrm{d}V = \oiint_S\vec{A}\cdot\vec{n}\mathrm{d}S$$
的共性是反映区域上的积分和它的边界上的积分的联系。
在介绍一般的Stokes定理前，先引入``带边流形''的概念。
$n$维带边流形的最简单例子是
$$\mathbb{R}^{n-} \coloneq \{(x^1, \cdots, x^n) \in \mathbb{R}^n \mid x^1 \leq 0\}$$
其中$x^1, \cdots, x^n$是自然坐标，由$x^1 = 0$的所有点组成的子集叫$\mathbb{R}^{n-}$的边界，它本身是个$n - 1$维流形（其实就是$\mathbb{R}^{n - 1}$）。
推广至一般情况，$n$维带边流形$N$与$n$维流形定义相仿，只是把该定义中的$\mathbb{R}^n$改为$\mathbb{R}^{n-}$，即$N$的开覆盖${O_\alpha}$中的每一元素$O_\alpha$都应同胚于$\mathbb{R}^{n-}$的一个子集，$N$中全体被映射到$x^1 = 0$处的点组成$N$的边界，记作$\partial N$。
请注意$\partial N$是$n - 1$维流形；$\operatorname{i}(N) \equiv N - \partial N$是$n$维流形。
例如，$\mathbb{R}^3$中的实心球体$B$是$3$维带边流形，其边界（$2$维球面$S^2$）是$2$维流形，$\operatorname{i}(B)$则是$3$维流形。

\begin{theorem}
    设$n$维定向流形$M$的紧致子集$N$是个$n$维带边流形，$\omega$是$M$上的$n - 1$形式场（可微性至少为$C^1$），则
    $$\int_{\operatorname{i}(N)}\mathrm{d}\omega = \int_{\partial N}\omega$$
\end{theorem}

\begin{note}
    把$M$的定向$\epsilon$限制在$N$上便得到$N$的定向，仍记作$\epsilon$,它在$N$的边界$\partial N$（$M$中的超曲面）上自然诱导出一个定向，记作$\bar\epsilon$,是$\bar\epsilon_{a_1 \cdots a_{n - 1}}$的简写。
    仅以$\mathbb{R}^{2-}$为例介绍，这时$M = \mathbb{R}^2, ~ N = \mathbb{R}^{2-}, ~ \partial N = \{(x^1, x^2) \mid x^1 = 0\}$。
    设$\mathbb{R}^2$（因而$\mathbb{R}^{2-}$）的定向为$\epsilon_{ab} = (\mathrm{d}x^1)_a \wedge (\mathrm{d}x^2)_b$，则$\{x^1, x^2\}$以$\epsilon_{ab}$衡量为右手系。
    因$x^1|_{\partial N} = 0$，把$x^1$开除后所得的$\{x^2\}$便是$\partial N$的一个坐标系。
    我们这样定义$\partial N$的诱导定向$\bar\epsilon_a$，使坐标系$\{x^2\}$以$\bar\epsilon_a$衡量为右手系。
    选$\bar\epsilon_a = (\mathrm{d}x^2)_a$便可满足这一要求。
    诱导定向的这个基本要求可以推广到任意带边流形$N$。
    上式左边是$n$形式场$\mathrm{d}\omega$在$n$维流形$\operatorname{i}(N)$（以$\epsilon$为定向）上的积分，右边是$n - 1$形式场$\omega$在$n - 1$维流形$\partial N$（以$\bar\epsilon$为定向）上的积分。
\end{note}

\begin{example}
    设$\vec{A}$是$2$维欧氏空间的矢量场，$L$是$\mathbb{R}^2$中的光滑闭合曲线，$S$是由$L$包围的开子集，$x^1, x^2$为笛卡尔坐标，则熟知的$2$维欧氏空间Stokes定理（又称Green定理）为
    $$\iint_S(\partial A_2 / \partial x^1 - \partial A_1 / \partial x^2)\mathrm{d}x^1\mathrm{d}x^2 = \oint_LA_l\mathrm{d}l$$

    现在说明上式是前述定理的特例。令$M = \mathbb{R}^2$，则$S \cup L$可认为是$N$，其中$S$和$L$分别对应$\operatorname{i}(N)$和$\partial N$。
    用欧氏度规$\delta_{ab}$把$A^a$变为$1$形式场（即对偶矢量）$A_a \equiv \delta_{ab}A^b$，则$A_a$对应$\omega$。把$A_a$用笛卡尔系对偶坐标基矢展开：$\omega = A_a = A_\mu(\mathrm{d}x^\mu)_a$，则
    $$\mathrm{d}\omega = \mathrm{d}A_\mu \wedge \mathrm{d}x^\mu = \frac{\partial A_\mu}{\partial x^\nu}\mathrm{d}x^\nu \wedge \mathrm{d}x^\mu = \frac{\partial A_1}{\partial x^2}\mathrm{d}x^2 \wedge \mathrm{d}x^1 + \frac{\partial A_2}{\partial x^1}\mathrm{d}x^1 \wedge \mathrm{d}x^2 = (\frac{\partial A_2}{\partial x^1} - \frac{\partial A_1}{\partial x^2})\mathrm{d}x^1 \wedge \mathrm{d}x^2$$
    其中第二个等号是$\mathrm{d}f$用对偶坐标基矢的展开式，可见上式左边可以表示为$\displaystyle\int_{\operatorname{i}(N)}\mathrm{d}\omega$。
    另一方面，$\displaystyle\int_{\partial N}\omega = \int_{\partial N}\tilde\omega$。
    选线长$l$为$L$的局部坐标，把$\tilde\omega$用坐标基矢展开为$\tilde\omega_a = \tilde\omega_1(l)(\mathrm{d}l)_a$，两边与$(\partial / \partial l)^a$缩并得
    $$\tilde\omega_1(l) = \tilde\omega_a(\partial / \partial l)^a = \omega_a(\partial / \partial l)^a = A_a(\partial / \partial l)^a = A_l$$
    故$\tilde\omega = A_l\mathrm{d}l$，于是
    $$\oint_L A_l\mathrm{d}l = \int_{\partial N}\omega$$
    可见，上式是Stokes定理的特例。
\end{example}

以上介绍了微分形式在流形上的积分及有关定理。
为了讲解函数在流形上的积分，先介绍体元的概念。

\section{体元}

\begin{definition}
    $n$维可定向流形$M$上的任一个$C^0$而且处处非零的$n$形式场$\epsilon$称为一个体元。
\end{definition}

\begin{note}
    体元与定向的区别在于：若$\epsilon_1$和$\epsilon_2$是两个$C^0$且处处非零的$n$形式场，而且有处处为正的函数$h$使$\epsilon_1 = h \epsilon_2$，则$\epsilon_1$和$\epsilon_2$代表同一个定向，但只要$\epsilon_1 \neq \epsilon_2$它们就是两个不同体元。
    对可定向连通流形，定向只有两个，而体元却有无限多个。
    谈及定向流形上的积分和体元时不要求流形上选定度规场，这时体元的选择十分任意（只有一个要求，就是体元与定向相容，即代表体元的$\epsilon$与代表定向的$\epsilon$之间的乘子为正。），没有一个与众不同的体元。
    然而，如果流形上给定了度规场$g_{ab}$，便存在选择特定体元的自然方法。
\end{note}

先考虑带度规$g_{ab}$的$2$维定向流形。
设$\epsilon_{a_1a_2}$为任一体元，则$\epsilon^{a_1a_2} \equiv g^{a_1b_1}g^{a_2b_2}\epsilon_{b_1b_2}$有意义，且$\epsilon^{a_1a_2}\epsilon_{a_1a_2}$是标量场，可借任一基底计算。
我们用正交归一基底。
若$g_{ab}$为正定度规，则
$$\epsilon^{a_1a_2}\epsilon_{a_1a_2} = \delta^{\mu_1\nu_1}\delta^{\mu_2\nu_2}\epsilon_{\nu_1\nu_2}\epsilon_{\mu_1\mu_2} = \delta^{11}\delta^{22}\epsilon_{12}\epsilon_{12} + \delta^{22}\delta^{11}\epsilon_{21}\epsilon_{21} = 2(\epsilon_{12})^2$$
若$g_{ab}$为洛伦兹度规，则
$$\epsilon^{a_1a_2}\epsilon_{a_1a_2} = \eta^{11}\eta^{22}\epsilon_{12}\epsilon_{12} + \eta^{22}\eta^{11}\epsilon_{21}\epsilon_{21} = -2(\epsilon_{12})^2$$
推广至带任意度规$g_{ab}$的$n$维流形有
$$\epsilon^{a_1 \cdots a_n}\epsilon_{a_1 \cdots a_n} = (-1)^sn!(\epsilon_{1 \cdots n})^2$$
其中$\epsilon_{1 \cdots n}$是$\epsilon_{a_1 \cdots a_n}$在正交归一基底的分量，$s$是$g_{ab}$在正交归一基底的分量中$-1$的个数，例如正定度规有$s = 0$，洛伦兹度规有$s = 1$。
所谓借用度规选择一个特定的体元，是指规定体元$\epsilon_{a_1 \cdots a_n}$在正交归一基$\{(e^\mu)_a\}$的分量满足如下的简单性要求：
$$\epsilon_{1 \cdots n} = \pm 1$$
即
$$\epsilon_{a_1 \cdots a_n} = \pm(e^1)_{a1} \wedge \cdots \wedge(e^n)_{a_n} \text{（对正交归一基）}$$
这相当于要求
$$\epsilon^{a_1 \cdots a_n}\epsilon_{a_1 \cdots a_n} = (-1)^sn!$$
满足上式的$\epsilon_{a_1 \cdots a_n}$称为与度规$g_{ab}$相适配（相容）的体元。
上式只把体元确定到差一个负号的程度，加上``体元与定向相容''的要求才确定唯一的体元。
于是上式右边的$+$和$-$号分别对应于右手和左手正交归一基。

小结 ~ 涉及积分时，我们只关心可定向流形$M$。首先选好一个定向使$M$成为定向流形。
任一基底的右（左）手性由所选定向规定。
没有度规场$g_{ab}$（或其他可资利用的几何结构）时，体元相当任意，但要求与定向相容。
指定$g_{ab}$后，体元$\epsilon_{a_1 \cdots a_n}$由$g_{ab}$以及``体元与定向相容''的要求唯一确定，简称适配体元。
今后如无特别声明，在有度规时提到体元都指这个唯一的适配体元。

在$3$维欧氏空间$(\mathbb{R}^3, \delta_{ab})$中任取一个符合直观含义的右手笛卡尔系$\{x, y, z\}$并指定$3$形式场$\epsilon = \mathrm{d}x \wedge \mathrm{d}y \wedge \mathrm{d}z$为定向，则$\{x, y, z\}$按定义就是以$\epsilon$衡量的右手系。
把$\epsilon = \mathrm{d}x \wedge \mathrm{d}y \wedge \mathrm{d}z$与上式对比可知$\epsilon$是适配体元。
设$G$是$\mathbb{R}^3$的开子集且普通积分$\displaystyle\iiint_G\mathrm{d}x\mathrm{d}y\mathrm{d}z$存在，则此积分自然代表$G$的体积（按普通微积分学的体积定义）。
另一方面，$3$形式场$\epsilon$在$G \subset \mathbb{R}^3$上的积分$\displaystyle\int_G\epsilon$正是$\displaystyle\iiint_G\mathrm{d}x\mathrm{d}y\mathrm{d}z$，可见$\displaystyle\int_G\epsilon$就是$G$的体积。
推广至任意带正定度规$g_{ab}$的定向流形$N$，设$\epsilon$为适配体元，若$\displaystyle\int_N\epsilon$存在，就称它为$N$的（用$g_{ab}$衡量的）体积（对$1, 2$维流形又分别叫长度和面积）。
这可看作把$\epsilon$称为体元的由来。

\begin{theorem}
    设$\epsilon$为适配体元，$\{(e_\mu)^a\}$及$\{(e^\mu)_a\}$为基底及其对偶基底，$g$为$g_{ab}$在此基底的分量组成的行列式，$|g|$为$g$的绝对值，则（式中$+$、$-$号分别适用于右手和左手基底）
    $$\epsilon_{a_1 \cdots a_n} = \pm\sqrt{|g|}(e^1)_{a_1} \wedge \cdots \wedge (e^n)_{a_n}$$
\end{theorem}

\begin{note}
    对正交归一基底有$|g| = 1$。
\end{note}

\begin{theorem}
    设$\nabla_a$和$\epsilon$分别是与度规相适配的导数算符和体元，则
    $$\nabla_b\epsilon_{a_1 \cdots a_n} = 0$$
\end{theorem}

\begin{proof}
    由$\nabla_bg_{ac} = 0$可得$\epsilon^{a_1 \cdots a_n}\nabla_b\epsilon_{a_1 \cdots a_n} = 0$\footnote{
        因为$\epsilon^{a_1 \cdots a_n}\epsilon_{a_1 \cdots a_n} = (-1)^sn!$，两边取导数得$\nabla_b(\epsilon^{a_1 \cdots a_n}\epsilon_{a_1 \cdots a_n}) = \nabla_b\epsilon^{a_1 \cdots a_n}\epsilon_{a_1 \cdots a_n} + \epsilon^{a_1 \cdots a_n}\nabla_b\epsilon_{a_1 \cdots a_n} = 0$。
        又$\nabla_bg_{ac} = 0$可导出$\nabla_bg^{ac} = 0$，故前式第一项为0。
    }，于是对任一矢量场$v^b$有（两边做缩并）
    $$\epsilon^{a_1 \cdots a_n}v^b\nabla_b\epsilon_{a_1 \cdots a_n} = 0$$
    因$M$中任一点的$n$形式的集合是$1$维矢量空间，故该点的任意两个$n$形式只能差到一个乘子$h$（对不同点$h$可不同），因此$v^b\nabla_b\epsilon_{a_1 \cdots a_n} = h\epsilon_{a_1 \cdots a_n}$。
    代入上式便给出$h = 0$，所以$v^b\nabla_b\epsilon_{a_1 \cdots a_n} = 0$。
    因$v^b$为任意矢量场，故$\nabla_b\epsilon_{a_1 \cdots a_n} = 0$。
\end{proof}

下面要证明关于体元的两个十分有用的等式，为此先要介绍下述引理。

\begin{theorem}
    $\delta^{[a_1}{}_{a_1} \cdots \delta^{a_j}{}_{a_j}\delta^{a_{j + 1}}{}_{b_{j + 1}} \cdots \delta^{a_n]}{}_{b_n} = \displaystyle\frac{(n - j)!j!}{n!}\delta^{[a_{j + 1}}{}_{b_{j + 1}} \cdots \delta^{a_n]}{}_{b_n}$
\end{theorem}

根据上述引理，可以证明

\begin{theorem}
    \begin{enumerate}[（a）]
        \item $\epsilon^{a_1 \cdots a_n}\epsilon_{b_1 \cdots b_n} = (-1)^sn!\delta^{[a_1}{}_{b_1} \cdots \delta^{a_n]}{}_{b_n}$
        \item $\epsilon^{a_1 \cdots a_j a_{j + 1} \cdots a_n}\epsilon_{a_1 \cdots a_j b_{j + 1} \cdots b_n} = (-1)^s(n - j)!j!\delta^{[a_{j + 1}}{}_{b_{j + 1}} \cdots \delta^{a_n]}{}_{b_n}$
    \end{enumerate}
\end{theorem}

\begin{proof}
    $\epsilon^{a_1 \cdots a_n}\epsilon_{b_1 \cdots b_n} = \epsilon^{[a_1 \cdots a_n]}\epsilon_{[b_1 \cdots b_n]}$表明$\epsilon^{a_1 \cdots a_n}\epsilon_{b_1 \cdots b_n}$对全部上标和全部下标都为反称。
    不难证明这种$(n, n)$型张量的集合是$1$维矢量空间，而$\delta^{[a_1}{}_{b_1} \cdots \delta^{a_n]}{}_{b_n}$属于这类张量（因为不难证明$\delta^{[a_1}{}_{b_1} \cdots \delta^{a_n]}{}_{b_n} = \delta^{[a_1}{}_{[b_1} \cdots \delta^{a_n]}{}_{b_n]}$），故任何这类张量与$\delta^{[a_1}{}_{b_1} \cdots \delta^{a_n]}{}_{b_n}$只差一个乘子，从而$\epsilon^{a_1 \cdots a_n}\epsilon_{b_1 \cdots b_n} = K\delta^{[a_1}{}_{b_1} \cdots \delta^{a_n]}{}_{b_n}$。
    与$\epsilon_{a_1 \cdots a_n}\epsilon^{b_1 \cdots b_n}$缩并，左边结果为$(-1)^sn!(-1)^sn!$，右边结果为$K\epsilon_{b_1 \cdots b_n}\epsilon^{b_1 \cdots b_n} = K(-1)^sn!$，于是$K = (-1)^sn!$，故得式（a）。
    两边分别对前$j$个上、下指标缩并得
    \[\begin{split}
        \epsilon^{a_1 \cdots a_j a_{j + 1} \cdots a_n}\epsilon_{a_1 \cdots a_j b_{j + 1} \cdots b_n} & = (-1)^sn!\delta^{[a_1}{}_{a_1} \cdots \delta^{a_j}{}_{a_j}\delta^{a_{j + 1}}{}_{b_{j + 1}} \cdots \delta^{a_n]}{}_{b_n} \\
        & = (-1)^s(n - j)!j!\delta^{[a_{j + 1}}{}_{b_{j + 1}} \cdots \delta^{a_n]}{}_{b_n}
    \end{split}\]
    （其中最末一步用到上述引理）可见式（b）成立。
\end{proof}

\section{函数在流形上的积分，Gauss定理}

\begin{definition}
    设$\epsilon$为流形$M$上的任一体元，$f$为$M$上的$C^0$函数，则$f$在$M$上的积分（记作$\displaystyle\int_Mf$）定义为$n$形式场$f\epsilon$在$M$上的积分，即
    $$\int_Mf \coloneq \int_Mf\epsilon$$
\end{definition}

由定义知函数的积分与体元的选择有关。
只要流形上给定度规，我们约定总是用适配体元来定义函数的积分。
这样，在带度规的定向流形上，函数给定后其积分也就确定。
以$3$维欧氏空间$(\mathbb{R}^3, \delta_{ab})$为例。
设$\{x, y, z\}$为右手笛卡尔系，则$\epsilon = \mathrm{d}x \wedge \mathrm{d}y \wedge \mathrm{d}z$是适配体元，于是$(\mathbb{R}^3, \delta_{ab})$上的函数$f \colon \mathbb{R}^3 \to \mathbb{R}$的积分按定义为$\displaystyle\int_{\mathbb{R}^3}f = \int_{\mathbb{R}^3}f\epsilon$，而右边无非是$3$形式场$\omega = f\epsilon$的积分。
设$f$与笛卡尔系$\{x, y, z\}$结合而得的$3$元函数为$F(x, y, z)$，则
$$\omega = F(x, y, z)\mathrm{d}x\wedge\mathrm{d}y\wedge\mathrm{d}z$$
故
$$\int f = \int f\epsilon = \int \omega = \iiint F(x, y, z) \mathrm{d}x\mathrm{d}y\mathrm{d}z$$
如果愿意，也可用（右手）球坐标系$\{r, \theta, \varphi\}$计算。由线元式$\mathrm{d}s^2$


\section{对偶微分形式}

